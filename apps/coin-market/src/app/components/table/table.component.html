<div class="container">
    <div class="elements-above-table">
        <h2>Bitcoin Markets</h2>
        <div class="pair-select">
            <p class="pair-text">Pair</p>
            <mat-select [(ngModel)]="selectedValue" name="pair">
                <mat-option *ngFor="let pair of pairs" [value]="pair.viewValue">
                    {{ pair.viewValue }}
                </mat-option>
            </mat-select>
        </div>
    </div>

    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
        <ng-container matColumnDef="position">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>#</th>
            <td mat-cell style="color: rgb(88, 102, 126)" *matCellDef="let market; let i = index">
                {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
            </td>
        </ng-container>

        <ng-container matColumnDef="source">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Source</th>
            <td mat-cell class="bold" *matCellDef="let market">
                <div class="icon-source">
                    <img class="icon" [src]="market.imageUrl" />
                    {{ market.source }}
                </div>
            </td>
        </ng-container>

        <ng-container matColumnDef="pairs">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Pairs</th>
            <td mat-cell class="table-pairs" *matCellDef="let market">
                {{ market.pairs }}
            </td>
        </ng-container>

        <ng-container matColumnDef="price">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Price</th>
            <td mat-cell style="font-weight: bold" *matCellDef="let market">
                {{ market.price | currency: 'USD':'$':'0.2-2' }}
            </td>
        </ng-container>

        <ng-container matColumnDef="volume">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Volume</th>
            <td mat-cell *matCellDef="let market">
                {{ market.volume | currency: 'USD':'$':'4.0-2' }}
            </td>
        </ng-container>

        <ng-container matColumnDef="volumePercentage">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Volume %</th>
            <td mat-cell *matCellDef="let market">
                {{ market.volumePercentage }}%
            </td>
        </ng-container>

        <ng-container matColumnDef="confidence">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                <span class="icon-confidence-liquidity">Confidence<img class="icon" nz-popover
                        [nzPopoverContent]="confidenceInfo" nzPopoverPlacement="bottom" src="assets/img/myinfo.png" />
                </span>
            </th>
            <td mat-cell *matCellDef="let market">
                <span class="confidence-level" [ngClass]="market.confidenceClass">
                    {{ market.confidence }}
                </span>
            </td>
        </ng-container>

        <ng-container matColumnDef="liquidity">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                <span class="icon-confidence-liquidity">Liquidity
                    <img class="icon" nz-popover [nzPopoverContent]="liquidityInfo" nzPopoverPlacement="bottom"
                        src="assets/img/myinfo.png" />
                </span>
            </th>
            <td mat-cell *matCellDef="let market">{{ market.liquidity }}</td>
        </ng-container>

        <ng-container matColumnDef="updated">
            <th mat-header-cell *matHeaderCellDef>Updated</th>
            <td mat-cell *matCellDef="let market">{{ market.updated }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    <mat-paginator #myPaginator [length]="dataLength | async" [pageSize]="5" [pageSizeOptions]="[5, 10, 25, 100]">
    </mat-paginator>
</div>

<ng-template #confidenceInfo>
    <div class="icon-info">
        <div class="icon-info-header">
            <p>Confidence Indicator</p>
            <a href="_blank">Read More</a>
        </div>
        <p>
            CoinMarketCap algorithmically compares the Reported Volume of
            exchanges against our data model. The Confidence Indicator indicates
            the level of confidence we have that the Reported Volume is
            accurate.
        </p>
        <p>
            Confidence Indicator reports a number from 0% to 100%, and are
            categorized into bands:
        </p>
        <div class="icon-info-footer">
            <div class="colors high">
                <p>76-100%</p>
                <p>High</p>
            </div>
            <div class="colors moderate">
                <p>51-75%</p>
                <p>Moderate</p>
            </div>
            <div class="colors low">
                <p>0-50%</p>
                <p>Low</p>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #liquidityInfo>
    <div class="icon-info">
        <div class="icon-info-header">
            <p>Liquidity Score</p>
            <a href="_blank">Read More</a>
        </div>
        <p>
            Liquidity scores a market pair from 0 to 1000 based on the slippage
            incurred by various order sizes. A higher score indicates a more
            liquid market.
        </p>
    </div>
</ng-template>